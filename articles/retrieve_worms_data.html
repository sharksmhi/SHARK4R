<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Retrieve Taxonomic Data From WoRMS • SHARK4R</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Retrieve Taxonomic Data From WoRMS">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">SHARK4R</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-tutorials" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Tutorials</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-tutorials">
<li><a class="dropdown-item" href="../articles/retrieve_shark_data.html">Retrieve SHARK Data</a></li>
    <li><a class="dropdown-item" href="../articles/retrieve_dyntaxa_data.html">Retrieve Dyntaxa Data</a></li>
    <li><a class="dropdown-item" href="../articles/retrieve_worms_data.html">Retrieve WoRMS Data</a></li>
    <li><a class="dropdown-item" href="../articles/retrieve_algaebase_data.html">Retrieve AlgaeBase Data</a></li>
    <li><a class="dropdown-item" href="../articles/retrieve_hab_data.html">Retrieve HAB Data</a></li>
    <li><a class="dropdown-item" href="../articles/retrieve_nordic_microalgae_data.html">Retrieve Nordic Microalgae Data</a></li>
    <li><a class="dropdown-item" href="../articles/quality_control.html">QC of SHARK Data</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/sharksmhi/SHARK4R/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Retrieve Taxonomic Data From WoRMS</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/sharksmhi/SHARK4R/blob/v.1.0.3/vignettes/retrieve_worms_data.Rmd" class="external-link"><code>vignettes/retrieve_worms_data.Rmd</code></a></small>
      <div class="d-none name"><code>retrieve_worms_data.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="worms">WoRMS<a class="anchor" aria-label="anchor" href="#worms"></a>
</h2>
<p>The World Register of Marine Species (WoRMS) is a comprehensive
database providing authoritative lists of marine organism names, managed
by taxonomic experts. It combines data from the Aphia database and other
sources like AlgaeBase and FishBase, offering species names, higher
classifications, and additional data. WoRMS is continuously updated and
maintained by taxonomists. In this tutorial, we source the R package <a href="https://CRAN.R-project.org/package=worrms" class="external-link"><code>worrms</code></a>
to access WoRMS data for our function. Please note that the authors of
<code>SHARK4R</code> are not affiliated with WoRMS.</p>
</div>
<div class="section level2">
<h2 id="getting-started">Getting Started<a class="anchor" aria-label="anchor" href="#getting-started"></a>
</h2>
<div class="section level4">
<h4 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h4>
<p>You can install the latest version of <code>SHARK4R</code> from CRAN
using:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"SHARK4R"</span><span class="op">)</span></span></code></pre></div>
<p>Load the <code>SHARK4R</code>, <code>dplyr</code> and
<code>ggplot2</code> libraries:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://sharksmhi.github.io/SHARK4R/">SHARK4R</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="retrieve-data-using-shark4r">Retrieve Data Using SHARK4R<a class="anchor" aria-label="anchor" href="#retrieve-data-using-shark4r"></a>
</h2>
<div class="section level3">
<h3 id="retrieve-phytoplankton-data-from-shark">Retrieve Phytoplankton Data From SHARK<a class="anchor" aria-label="anchor" href="#retrieve-phytoplankton-data-from-shark"></a>
</h3>
<p>Phytoplankton data, including scientific names and AphiaIDs, are
downloaded from SHARK. To see more download options, please visit the <a href="https://sharksmhi.github.io/SHARK4R/articles/retrieve_shark_data.html">Retrieve
Data From SHARK</a> tutorial.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Retrieve all phytoplankton data from April 2015</span></span>
<span><span class="va">shark_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_shark_data.html">get_shark_data</a></span><span class="op">(</span>fromYear <span class="op">=</span> <span class="fl">2015</span>, </span>
<span>                             toYear <span class="op">=</span> <span class="fl">2015</span>,</span>
<span>                             months <span class="op">=</span> <span class="fl">4</span>, </span>
<span>                             dataTypes <span class="op">=</span> <span class="st">"Phytoplankton"</span>,</span>
<span>                             verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="match-taxa-names">Match Taxa Names<a class="anchor" aria-label="anchor" href="#match-taxa-names"></a>
</h3>
<p>Taxon names can be matched with the WoRMS API to retrieve Aphia IDs
and corresponding taxonomic information. The
<code><a href="../reference/match_worms_taxa.html">match_worms_taxa()</a></code> function incorporates retry logic to
handle temporary failures, ensuring that all names are processed
successfully.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Find taxa without Aphia ID</span></span>
<span><span class="va">no_aphia_id</span> <span class="op">&lt;-</span> <span class="va">shark_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">aphia_id</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Randomly select taxa with missing aphia_id</span></span>
<span><span class="va">taxa_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">no_aphia_id</span><span class="op">$</span><span class="va">scientific_name</span><span class="op">)</span>, </span>
<span>                     size <span class="op">=</span> <span class="fl">10</span>,</span>
<span>                     replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Match taxa names with WoRMS</span></span>
<span><span class="va">worms_records</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/match_worms_taxa.html">match_worms_taxa</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">taxa_names</span><span class="op">)</span>,</span>
<span>                                  fuzzy <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                                  best_match_only <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                                  marine_only <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                                  verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Print result</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">worms_records</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 4 × 29</span></span></span>
<span><span class="co">##   name        status AphiaID rank  scientificname url   authority unacceptreason</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> Unicell     no co…      <span style="color: #BB0000;">NA</span> <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>             <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>        <span style="color: #BB0000;">NA</span>            </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> Scrippsiel… accep…  <span style="text-decoration: underline;">109</span>545 Genus Scrippsiella   http… Balech e… <span style="color: #BB0000;">NA</span>            </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> Cylindroth… accep…  <span style="text-decoration: underline;">149</span>004 Spec… Cylindrotheca… http… (Ehrenbe… <span style="color: #BB0000;">NA</span>            </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span> Diplopsalis accep…  <span style="text-decoration: underline;">109</span>515 Genus Diplopsalis    http… R.S.Berg… <span style="color: #BB0000;">NA</span>            </span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 21 more variables: taxonRankID &lt;int&gt;, valid_AphiaID &lt;int&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   valid_name &lt;chr&gt;, valid_authority &lt;chr&gt;, parentNameUsageID &lt;int&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   originalNameUsageID &lt;int&gt;, kingdom &lt;chr&gt;, phylum &lt;chr&gt;, class &lt;chr&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   order &lt;chr&gt;, family &lt;chr&gt;, genus &lt;chr&gt;, citation &lt;chr&gt;, lsid &lt;chr&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   isMarine &lt;int&gt;, isBrackish &lt;int&gt;, isFreshwater &lt;int&gt;, isTerrestrial &lt;int&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   isExtinct &lt;lgl&gt;, match_type &lt;chr&gt;, modified &lt;chr&gt;</span></span></span></code></pre>
</div>
<div class="section level3">
<h3 id="get-worms-records-from-aphiaid">Get WoRMS records from AphiaID<a class="anchor" aria-label="anchor" href="#get-worms-records-from-aphiaid"></a>
</h3>
<p>Taxonomic records can also be retrieved using Aphia IDs, employing
the same retry and error-handling logic as the
<code><a href="../reference/match_worms_taxa.html">match_worms_taxa()</a></code> function.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Randomly select ten Aphia IDs</span></span>
<span><span class="va">aphia_ids</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">shark_data</span><span class="op">$</span><span class="va">aphia_id</span><span class="op">)</span>, </span>
<span>                    size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Remove NAs</span></span>
<span><span class="va">aphia_ids</span> <span class="op">&lt;-</span> <span class="va">aphia_ids</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">aphia_ids</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Retrieve records</span></span>
<span><span class="va">worms_records</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_worms_records.html">get_worms_records</a></span><span class="op">(</span><span class="va">aphia_ids</span>,</span>
<span>                                   verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Print result</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">worms_records</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 10 × 28</span></span></span>
<span><span class="co">##    AphiaID url        scientificname authority status unacceptreason taxonRankID</span></span>
<span><span class="co">##      <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>                <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> 1<span style="text-decoration: underline;">310</span>442 https://w… Octactis spec… (Ehrenbe… accep… <span style="color: #BB0000;">NA</span>                     220</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span>  <span style="text-decoration: underline;">146</span>715 https://w… Aphanothece    Nägeli, … accep… <span style="color: #BB0000;">NA</span>                     180</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span>  <span style="text-decoration: underline;">837</span>459 https://w… Tripos lineat… (Ehrenbe… accep… <span style="color: #BB0000;">NA</span>                     220</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span>  <span style="text-decoration: underline;">134</span>529 https://w… Pyramimonas    Schmarda… accep… <span style="color: #BB0000;">NA</span>                     180</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span>  <span style="text-decoration: underline;">575</span>737 https://w… Binuclearia l… (Schmidl… accep… <span style="color: #BB0000;">NA</span>                     220</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span>  <span style="text-decoration: underline;">110</span>153 https://w… Heterocapsa t… (Ehrenbe… unacc… <span style="color: #BB0000;">NA</span>                     220</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span>  <span style="text-decoration: underline;">148</span>899 https://w… Bacillariophy… Haeckel,… accep… <span style="color: #BB0000;">NA</span>                      60</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span>  <span style="text-decoration: underline;">106</span>287 https://w… Hemiselmis     Parke, 1… accep… <span style="color: #BB0000;">NA</span>                     180</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span>  <span style="text-decoration: underline;">249</span>711 https://w… Desmodesmus    (R.Choda… accep… <span style="color: #BB0000;">NA</span>                     180</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span>  <span style="text-decoration: underline;">109</span>553 https://w… Protoperidini… Bergh, 1… accep… <span style="color: #BB0000;">NA</span>                     180</span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 21 more variables: rank &lt;chr&gt;, valid_AphiaID &lt;int&gt;, valid_name &lt;chr&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   valid_authority &lt;chr&gt;, parentNameUsageID &lt;int&gt;, originalNameUsageID &lt;int&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   kingdom &lt;chr&gt;, phylum &lt;chr&gt;, class &lt;chr&gt;, order &lt;chr&gt;, family &lt;chr&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   genus &lt;chr&gt;, citation &lt;chr&gt;, lsid &lt;chr&gt;, isMarine &lt;int&gt;, isBrackish &lt;int&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   isFreshwater &lt;int&gt;, isTerrestrial &lt;int&gt;, isExtinct &lt;lgl&gt;, match_type &lt;chr&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   modified &lt;chr&gt;</span></span></span></code></pre>
</div>
<div class="section level3">
<h3 id="get-worms-taxonomy">Get WoRMS Taxonomy<a class="anchor" aria-label="anchor" href="#get-worms-taxonomy"></a>
</h3>
<p>SHARK sources taxonomic information from <a href="https://artfakta.se/" class="external-link">Dyntaxa</a>, which is reflected in columns
starting with <code>taxon_xxxxx</code>. Equivalent columns based on
WoRMS can be retrieved using the <code><a href="../reference/add_worms_taxonomy.html">add_worms_taxonomy()</a></code>
function.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Retrieve taxonomic table</span></span>
<span><span class="va">worms_taxonomy</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_worms_taxonomy.html">add_worms_taxonomy</a></span><span class="op">(</span><span class="va">aphia_ids</span>,</span>
<span>                                     verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Print result</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">worms_taxonomy</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 10 × 10</span></span></span>
<span><span class="co">##    aphia_id worms_scientific_name    worms_kingdom worms_phylum     worms_class </span></span>
<span><span class="co">##       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span>  1<span style="text-decoration: underline;">310</span>442 Octactis speculum        Chromista     Ochrophyta       Dictyochoph…</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span>   <span style="text-decoration: underline;">146</span>715 Aphanothece              Bacteria      Cyanobacteria    Cyanophyceae</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span>   <span style="text-decoration: underline;">837</span>459 Tripos lineatus          Chromista     Myzozoa          Dinophyceae </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span>   <span style="text-decoration: underline;">134</span>529 Pyramimonas              Plantae       <span style="color: #BB0000;">NA</span>               Pyramimonad…</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span>   <span style="text-decoration: underline;">575</span>737 Binuclearia lauterbornii Plantae       <span style="color: #BB0000;">NA</span>               Ulvophyceae </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span>   <span style="text-decoration: underline;">110</span>153 Heterocapsa triquetra    Chromista     Myzozoa          Dinophyceae </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span>   <span style="text-decoration: underline;">148</span>899 Bacillariophyceae        Chromista     Heterokontophyta Bacillariop…</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span>   <span style="text-decoration: underline;">106</span>287 Hemiselmis               Chromista     Cryptophyta      Cryptophyce…</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span>   <span style="text-decoration: underline;">249</span>711 Desmodesmus              Plantae       <span style="color: #BB0000;">NA</span>               Chlorophyce…</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span>   <span style="text-decoration: underline;">109</span>553 Protoperidinium          Chromista     Myzozoa          Dinophyceae </span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 5 more variables: worms_order &lt;chr&gt;, worms_family &lt;chr&gt;, worms_genus &lt;chr&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   worms_species &lt;chr&gt;, worms_hierarchy &lt;chr&gt;</span></span></span></code></pre>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Enrich SHARK data with taxonomic data from WoRMS</span></span>
<span><span class="va">shark_data_with_worms</span> <span class="op">&lt;-</span> <span class="va">shark_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">worms_taxonomy</span>, by <span class="op">=</span> <span class="st">"aphia_id"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="retrieve-worms-taxonomic-hierarchies">Retrieve WoRMS Taxonomic Hierarchies<a class="anchor" aria-label="anchor" href="#retrieve-worms-taxonomic-hierarchies"></a>
</h3>
<p>To explore the full hierarchical taxonomy records of your Aphia IDs,
you can use the <code><a href="../reference/get_worms_taxonomy_tree.html">get_worms_taxonomy_tree()</a></code> function. This
function retrieves records for the entire taxonomic tree from WoRMS,
including parent-child relationships, and can optionally fetch all
descendants (e.g. species) under a genus or known synonyms.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Retrieve taxonomic tree</span></span>
<span><span class="va">worms_tree</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_worms_taxonomy_tree.html">get_worms_taxonomy_tree</a></span><span class="op">(</span></span>
<span>  <span class="va">aphia_ids</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,                <span class="co"># use first id only in this example</span></span>
<span>  add_descendants <span class="op">=</span> <span class="cn">FALSE</span>,     <span class="co"># only retrieve hierarchy for given AphiaIDs</span></span>
<span>  add_synonyms <span class="op">=</span> <span class="cn">FALSE</span>,        <span class="co"># do not retrieve synonyms</span></span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>              <span class="co"># suppress progress messages</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Print result</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">worms_tree</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 9 × 28</span></span></span>
<span><span class="co">##   AphiaID url   scientificname authority status unacceptreason taxonRankID rank </span></span>
<span><span class="co">##     <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>                <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>       7 http… Chromista      <span style="color: #BB0000;">NA</span>        accep… <span style="color: #BB0000;">NA</span>                      10 King…</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span>  <span style="text-decoration: underline;">582</span>419 http… Harosa         <span style="color: #BB0000;">NA</span>        accep… <span style="color: #BB0000;">NA</span>                      20 Subk…</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span>  <span style="text-decoration: underline;">368</span>898 http… Heterokonta    <span style="color: #BB0000;">NA</span>        accep… <span style="color: #BB0000;">NA</span>                      25 Infr…</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span>  <span style="text-decoration: underline;">345</span>465 http… Ochrophyta     Cavalier… accep… <span style="color: #BB0000;">NA</span>                      30 Phyl…</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span>  <span style="text-decoration: underline;">146</span>232 http… Dictyochophyc… P.C. Sil… accep… <span style="color: #BB0000;">NA</span>                      60 Class</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">6</span>  <span style="text-decoration: underline;">157</span>256 http… Dictyochales   Haeckel,… accep… <span style="color: #BB0000;">NA</span>                     100 Order</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">7</span>  <span style="text-decoration: underline;">157</span>257 http… Dictyochaceae  Lemmerma… accep… <span style="color: #BB0000;">NA</span>                     140 Fami…</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">8</span>  <span style="text-decoration: underline;">369</span>960 http… Octactis       J.Schill… accep… <span style="color: #BB0000;">NA</span>                     180 Genus</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">9</span> 1<span style="text-decoration: underline;">310</span>442 http… Octactis spec… (Ehrenbe… accep… <span style="color: #BB0000;">NA</span>                     220 Spec…</span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 20 more variables: valid_AphiaID &lt;int&gt;, valid_name &lt;chr&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   valid_authority &lt;chr&gt;, parentNameUsageID &lt;int&gt;, originalNameUsageID &lt;int&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   kingdom &lt;chr&gt;, phylum &lt;chr&gt;, class &lt;chr&gt;, order &lt;chr&gt;, family &lt;chr&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   genus &lt;chr&gt;, citation &lt;chr&gt;, lsid &lt;chr&gt;, isMarine &lt;int&gt;, isBrackish &lt;int&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   isFreshwater &lt;int&gt;, isTerrestrial &lt;int&gt;, isExtinct &lt;lgl&gt;, match_type &lt;chr&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   modified &lt;chr&gt;</span></span></span></code></pre>
</div>
<div class="section level3">
<h3 id="assign-phytoplankton-groups">Assign Phytoplankton Groups<a class="anchor" aria-label="anchor" href="#assign-phytoplankton-groups"></a>
</h3>
<p>Phytoplankton data are often categorized into major groups such as
Dinoflagellates, Diatoms, Cyanobacteria, and Others. This grouping can
be achieved by referencing information from WoRMS and assigning taxa to
these groups based on their taxonomic classification, as demonstrated in
the example below.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Subset data from one national monitoring station</span></span>
<span><span class="va">nat_stations</span> <span class="op">&lt;-</span> <span class="va">shark_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">station_name</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"BY5 BORNHOLMSDJ"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Randomly select one sample from the nat_stations</span></span>
<span><span class="va">sample</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">nat_stations</span><span class="op">$</span><span class="va">shark_sample_id_md5</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Subset the random sample</span></span>
<span><span class="va">shark_data_subset</span> <span class="op">&lt;-</span> <span class="va">shark_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">shark_sample_id_md5</span> <span class="op">==</span> <span class="va">sample</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Assign groups by providing both scientific name and Aphia ID</span></span>
<span><span class="va">plankton_groups</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/assign_phytoplankton_group.html">assign_phytoplankton_group</a></span><span class="op">(</span></span>
<span>  scientific_names <span class="op">=</span> <span class="va">shark_data_subset</span><span class="op">$</span><span class="va">scientific_name</span>,</span>
<span>  aphia_ids <span class="op">=</span> <span class="va">shark_data_subset</span><span class="op">$</span><span class="va">aphia_id</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Print result</span></span>
<span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html" class="external-link">distinct</a></span><span class="op">(</span><span class="va">plankton_groups</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 23 × 2</span></span></span>
<span><span class="co">##    scientific_name      plankton_group </span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> Pauliella taeniata   Diatoms        </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> Amylax triacantha    Dinoflagellates</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> Aphanocapsa          Cyanobacteria  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> Aphanothece          Cyanobacteria  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> Chaetoceros similis  Diatoms        </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> Dinobryon balticum   Other          </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> Dinophysis acuminata Dinoflagellates</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> Dinophysis norvegica Dinoflagellates</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> Gymnodinium          Dinoflagellates</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> Protodinium simplex  Other          </span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 13 more rows</span></span></span></code></pre>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Add plankton groups to data and summarize abundance results</span></span>
<span><span class="va">plankton_group_sum</span> <span class="op">&lt;-</span> <span class="va">shark_data_subset</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>plankton_group <span class="op">=</span> <span class="va">plankton_groups</span><span class="op">$</span><span class="va">plankton_group</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">parameter</span> <span class="op">==</span> <span class="st">"Abundance"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">plankton_group</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>sum_plankton_groups <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">value</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot a pie chart</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">plankton_group_sum</span>, </span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">""</span>, y <span class="op">=</span> <span class="va">sum_plankton_groups</span>, fill <span class="op">=</span> <span class="va">plankton_group</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_col</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_radial.html" class="external-link">coord_polar</a></span><span class="op">(</span>theta <span class="op">=</span> <span class="st">"y"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Phytoplankton Groups"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">shark_data_subset</span><span class="op">$</span><span class="va">station_name</span><span class="op">)</span>,</span>
<span>                     <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">shark_data_subset</span><span class="op">$</span><span class="va">sample_date</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    fill <span class="op">=</span> <span class="st">"Plankton Group"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_void</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>plot.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_rect</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"white"</span>, color <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="retrieve_worms_data_files/figure-html/unnamed-chunk-9-1.png" class="r-plt" alt="" width="700"></p>
<div class="section level4">
<h4 id="assign-custom-phytoplankton-groups">Assign Custom Phytoplankton Groups<a class="anchor" aria-label="anchor" href="#assign-custom-phytoplankton-groups"></a>
</h4>
<p>You can add custom plankton groups by using the
<code>custom_groups</code> parameter, allowing flexibility to categorize
plankton based on specific taxonomic criteria. Please note that the
order of the list matters: taxa are assigned to the last matching group.
For example: Mesodinium rubrum will be excluded from the Ciliates group
because it appears after Ciliates in the list in the example below.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Define custom plankton groups using a named list</span></span>
<span><span class="va">custom_groups</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="st">"Cryptophytes"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>class <span class="op">=</span> <span class="st">"Cryptophyceae"</span><span class="op">)</span>,</span>
<span>  <span class="st">"Green Algae"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>class <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Trebouxiophyceae"</span>, </span>
<span>                                 <span class="st">"Chlorophyceae"</span>, </span>
<span>                                 <span class="st">"Pyramimonadophyceae"</span><span class="op">)</span>,</span>
<span>                       phylum <span class="op">=</span> <span class="st">"Chlorophyta"</span><span class="op">)</span>,</span>
<span>  <span class="st">"Ciliates"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>phylum <span class="op">=</span> <span class="st">"Ciliophora"</span><span class="op">)</span>,</span>
<span>  <span class="st">"Mesodinium rubrum"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>scientific_name <span class="op">=</span> <span class="st">"Mesodinium rubrum"</span><span class="op">)</span>,</span>
<span>  <span class="st">"Dinophysis"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>genus <span class="op">=</span> <span class="st">"Dinophysis"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Assign groups by providing scientific name only, and adding custom groups</span></span>
<span><span class="va">plankton_groups</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/assign_phytoplankton_group.html">assign_phytoplankton_group</a></span><span class="op">(</span></span>
<span>  scientific_names <span class="op">=</span> <span class="va">shark_data_subset</span><span class="op">$</span><span class="va">scientific_name</span>,</span>
<span>  custom_groups <span class="op">=</span> <span class="va">custom_groups</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Add new plankton groups to data and summarize abundance results</span></span>
<span><span class="va">plankton_custom_group_sum</span> <span class="op">&lt;-</span> <span class="va">shark_data_subset</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>plankton_group <span class="op">=</span> <span class="va">plankton_groups</span><span class="op">$</span><span class="va">plankton_group</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">parameter</span> <span class="op">==</span> <span class="st">"Abundance"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">plankton_group</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>sum_plankton_groups <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">value</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot a new pie chart, including the custom groups</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">plankton_custom_group_sum</span>, </span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">""</span>, y <span class="op">=</span> <span class="va">sum_plankton_groups</span>, fill <span class="op">=</span> <span class="va">plankton_group</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_col</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_radial.html" class="external-link">coord_polar</a></span><span class="op">(</span>theta <span class="op">=</span> <span class="st">"y"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Phytoplankton Custom Groups"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">shark_data_subset</span><span class="op">$</span><span class="va">station_name</span><span class="op">)</span>,</span>
<span>                     <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">shark_data_subset</span><span class="op">$</span><span class="va">sample_date</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    fill <span class="op">=</span> <span class="st">"Plankton Group"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_void</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>plot.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_rect</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"white"</span>, color <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="retrieve_worms_data_files/figure-html/unnamed-chunk-10-1.png" class="r-plt" alt="" width="700"></p>
<hr>
</div>
</div>
</div>
<div class="section level2">
<h2 id="citation">Citation<a class="anchor" aria-label="anchor" href="#citation"></a>
</h2>
<pre><code><span><span class="co">## To cite package 'SHARK4R' in publications use:</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   Lindh, M. and Torstensson, A. (2026). SHARK4R: Accessing and</span></span>
<span><span class="co">##   Validating Marine Environmental Data from 'SHARK' and Related</span></span>
<span><span class="co">##   Databases. R package version 1.0.3.</span></span>
<span><span class="co">##   https://CRAN.R-project.org/package=SHARK4R</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## A BibTeX entry for LaTeX users is</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   @Manual{,</span></span>
<span><span class="co">##     title = {SHARK4R: Accessing and Validating Marine Environmental Data from 'SHARK' and Related Databases},</span></span>
<span><span class="co">##     author = {Markus Lindh and Anders Torstensson},</span></span>
<span><span class="co">##     year = {2026},</span></span>
<span><span class="co">##     note = {R package version 1.0.3},</span></span>
<span><span class="co">##     url = {https://CRAN.R-project.org/package=SHARK4R},</span></span>
<span><span class="co">##   }</span></span></code></pre>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Markus Lindh, Anders Torstensson, SBDI.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
