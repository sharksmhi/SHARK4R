<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Check station distances against SMHI station list — check_station_distance • SHARK4R</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Check station distances against SMHI station list — check_station_distance"><meta name="description" content='Matches reported station names against the SMHI curated station list
("station.txt") and checks whether matched stations fall within
pre-defined distance limits. This helps ensure that station assignments
are spatially consistent.'><meta property="og:description" content='Matches reported station names against the SMHI curated station list
("station.txt") and checks whether matched stations fall within
pre-defined distance limits. This helps ensure that station assignments
are spatially consistent.'><meta property="og:image" content="https://sharksmhi.github.io/SHARK4R/logo.png"><!-- dependencies from examples --><script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script><link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet"><script src="libs/leaflet-1.3.1/leaflet.js"></script><link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet"><script src="libs/proj4-2.6.2/proj4.min.js"></script><script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script><link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet"><script src="libs/leaflet-binding-2.2.3/leaflet.js"></script><script src="libs/leaflet-providers-2.0.0/leaflet-providers_2.0.0.js"></script><script src="libs/leaflet-providers-plugin-2.2.3/leaflet-providers-plugin.js"></script><link href="libs/leaflet-awesomemarkers-2.0.3/leaflet.awesome-markers.css" rel="stylesheet"><script src="libs/leaflet-awesomemarkers-2.0.3/leaflet.awesome-markers.min.js"></script><link href="libs/fontawesome-4.7.0/font-awesome.min.css" rel="stylesheet"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">SHARK4R</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.7.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-tutorials" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Tutorials</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-tutorials"><li><a class="dropdown-item" href="../articles/retrieve_shark_data.html">Retrieve SHARK Data</a></li>
    <li><a class="dropdown-item" href="../articles/retrieve_dyntaxa_data.html">Retrieve Dyntaxa Data</a></li>
    <li><a class="dropdown-item" href="../articles/retrieve_worms_data.html">Retrieve WoRMS Data</a></li>
    <li><a class="dropdown-item" href="../articles/retrieve_algaebase_data.html">Retrieve AlgaeBase Data</a></li>
    <li><a class="dropdown-item" href="../articles/retrieve_hab_data.html">Retrieve HAB Data</a></li>
    <li><a class="dropdown-item" href="../articles/retrieve_nordic_microalgae_data.html">Retrieve Nordic Microalgae Data</a></li>
    <li><a class="dropdown-item" href="../articles/quality_control.html">QC of SHARK Data</a></li>
  </ul></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/sharksmhi/SHARK4R/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Check station distances against SMHI station list</h1>
      <small class="dont-index">Source: <a href="https://github.com/sharksmhi/SHARK4R/blob/master/R/check_stations.R" class="external-link"><code>R/check_stations.R</code></a></small>
      <div class="d-none name"><code>check_station_distance.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Matches reported station names against the SMHI curated station list
(<code>"station.txt"</code>) and checks whether matched stations fall within
pre-defined distance limits. This helps ensure that station assignments
are spatially consistent.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">check_station_distance</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  station_file <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  plot_leaflet <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  try_synonyms <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  fallback_crs <span class="op">=</span> <span class="fl">4326</span>,</span>
<span>  only_bad <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>A data frame containing at least the columns:
<code>station_name</code>, <code>sample_longitude_dd</code>, <code>sample_latitude_dd</code>.</p></dd>


<dt id="arg-station-file">station_file<a class="anchor" aria-label="anchor" href="#arg-station-file"></a></dt>
<dd><p>Optional path to a custom station file (tab-delimited).
If <code>NULL</code> (default), the function will first attempt to use the
<code>NODC_CONFIG</code> environment variable, and if that fails, will use the
bundled <code>"station.zip"</code> from the <code>SHARK4R</code> package.</p></dd>


<dt id="arg-plot-leaflet">plot_leaflet<a class="anchor" aria-label="anchor" href="#arg-plot-leaflet"></a></dt>
<dd><p>Logical; if <code>TRUE</code>, displays a leaflet map with
SMHI stations (blue circles with radius in popup) and reported stations
(green/red/gray markers). Default is <code>FALSE</code>.</p></dd>


<dt id="arg-try-synonyms">try_synonyms<a class="anchor" aria-label="anchor" href="#arg-try-synonyms"></a></dt>
<dd><p>Logical; if <code>TRUE</code> (default), unmatched station
names are also compared against the <code>SYNONYM_NAMES</code> column in
the station database.</p></dd>


<dt id="arg-fallback-crs">fallback_crs<a class="anchor" aria-label="anchor" href="#arg-fallback-crs"></a></dt>
<dd><p>Integer; CRS (EPSG code) to use when creating spatial
points if no CRS is available. Defaults to <code>4326</code> (WGS84). Change this
if your coordinates are reported in another CRS (e.g., <code>3006</code> for
SWEREF99 TM).</p></dd>


<dt id="arg-only-bad">only_bad<a class="anchor" aria-label="anchor" href="#arg-only-bad"></a></dt>
<dd><p>Logical; if <code>TRUE</code>, the leaflet map will only display
stations that are outside the allowed radius (red markers). Default is <code>FALSE</code>.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>Logical. If TRUE, messages will be displayed during execution. Defaults to TRUE.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>If <code>plot_leaflet = FALSE</code>, returns a data frame with columns:</p><dl><dt>station_name</dt>
<dd><p>Reported station name.</p></dd>

<dt>match_type</dt>
<dd><p><code>TRUE</code> if station matched in SMHI list, <code>FALSE</code> otherwise.</p></dd>

<dt>distance_m</dt>
<dd><p>Distance in meters from reported station to matched SMHI station.</p></dd>

<dt>within_limit</dt>
<dd><p><code>TRUE</code> if distance &lt;= allowed radius, <code>FALSE</code> if outside, <code>NA</code> if unmatched.</p></dd>


</dl><p>If <code>plot_leaflet = TRUE</code>, the function produces a leaflet map showing:</p><ul><li><p>Blue circles for SMHI stations with radius in the popup.</p></li>
<li><p>Reported stations colored by status: green (within radius), red (outside radius), gray (unmatched).</p></li>
<li><p>If <code>only_bad = TRUE</code>, only the red stations (outside radius) are displayed.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Optionally, a leaflet map of stations can be plotted. SMHI stations that
match the reported data are shown as blue circles, with their allowed
radius visualized and displayed in the popup (e.g., "ST1 (Radius: 1000 m)").
Reported stations are shown as markers colored by whether they fall within
the radius (green), outside the radius (red), or unmatched (gray).</p>
<p>If <code>try_synonyms = TRUE</code>, the function will attempt a second match
using the <code>SYNONYM_NAMES</code> column in the station database, splitting
multiple synonyms separated by <code>&lt;or&gt;</code>.</p>
<p>The function first checks if a station file path is provided via the
<code>station_file</code> argument. If not, it looks for the
<code>NODC_CONFIG</code> environment variable. This variable can point to a folder
where the NODC (Swedish National Oceanographic Data Center) configuration and station file
are stored, typically including:</p><ul><li><p><code>&lt;NODC_CONFIG&gt;/nodc_station/station.txt</code></p></li>
</ul><p>If <code>NODC_CONFIG</code> is set and the folder exists, the function will use
<code>station.txt</code> from that location. Otherwise, it falls back to the
bundled <code>station.zip</code> included in the <code>SHARK4R</code> package.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  station_name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ANHOLT E"</span>, <span class="st">"BY5 BORNHOLMSDJ"</span>, <span class="st">"NEW STATION"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  sample_longitude_dd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">12.1</span>, <span class="fl">15.97</span>, <span class="fl">17.5</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  sample_latitude_dd  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">56.7</span>, <span class="fl">55.25</span>, <span class="fl">58.7</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">check_station_distance</span><span class="op">(</span><span class="va">df</span>, plot_leaflet <span class="op">=</span> <span class="cn">FALSE</span>, try_synonyms <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Using station.txt from SHARK4R bundle:/home/runner/work/_temp/Library/SHARK4R/extdata/station.zip</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> WARNING: Unmatched stations found, check synonyms</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "NEW STATION"</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> WARNING: Some stations are outside the allowed distance limit</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   station_name distance_m OUT_OF_BOUNDS_RADIUS</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     ANHOLT E       3551                 3000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      station_name sample_longitude_dd sample_latitude_dd distance_m</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1        ANHOLT E               12.10              56.70  3551.0004</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 BY5 BORNHOLMSDJ               15.97              55.25   898.1066</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3     NEW STATION               17.50              58.70         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   within_limit</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1        FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2         TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3           NA</span>
<span class="r-in"><span><span class="fu">check_station_distance</span><span class="op">(</span><span class="va">df</span>, plot_leaflet <span class="op">=</span> <span class="cn">TRUE</span>, only_bad <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Using station.txt from SHARK4R bundle:/home/runner/work/_temp/Library/SHARK4R/extdata/station.zip</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> WARNING: Unmatched stations found, check synonyms</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "NEW STATION"</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> WARNING: Some stations are outside the allowed distance limit</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   station_name distance_m OUT_OF_BOUNDS_RADIUS</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     ANHOLT E       3551                 3000</span>
<div id="htmlwidget-36aa3d2a04d42bbc2145" style="width:700px;height:432.632880098888px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-36aa3d2a04d42bbc2145">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addProviderTiles","args":["CartoDB.Positron",null,null,{"errorTileUrl":"","noWrap":true,"detectRetina":false}]},{"method":"addCircleMarkers","args":[56.66866,12.11117,5,null,null,{"interactive":true,"className":"","stroke":true,"color":"blue","weight":5,"opacity":0.5,"fill":true,"fillColor":"blue","fillOpacity":0.7},null,null,"ANHOLT E (Radius: 3000 m)",null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addCircles","args":[56.66866,12.11117,3000,null,null,{"interactive":true,"className":"","stroke":true,"color":"blue","weight":5,"opacity":0.5,"fill":false,"fillColor":"blue","fillOpacity":0.2},null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null,null]},{"method":"addAwesomeMarkers","args":[56.7,12.1,{"icon":"map-marker","markerColor":"red","iconColor":"white","spin":false,"squareMarker":false,"iconRotate":0,"font":"monospace","prefix":"fa"},null,null,{"interactive":true,"draggable":false,"keyboard":true,"title":"","alt":"","zIndexOffset":0,"opacity":1,"riseOnHover":false,"riseOffset":250},"ANHOLT E",null,null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addTiles","args":["https://tiles.openseamap.org/seamark/{z}/{x}/{y}.png",null,null,{"errorTileUrl":"","noWrap":true,"detectRetina":false,"attribution":"&copy; OpenSeaMap contributors, OpenStreetMap contributors"}]}],"limits":{"lat":[56.66866,56.7],"lng":[12.1,12.11117]}},"evals":[],"jsHooks":[]}</script><span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Markus Lindh, Anders Torstensson, SBDI.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

