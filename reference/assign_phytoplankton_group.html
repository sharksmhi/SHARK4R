<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Assign phytoplankton group to scientific names — assign_phytoplankton_group • SHARK4R</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Assign phytoplankton group to scientific names — assign_phytoplankton_group"><meta name="description" content="This function assigns default phytoplankton groups (Diatoms, Dinoflagellates, Cyanobacteria, or Other)
to a list of scientific names or Aphia IDs by retrieving species information from the
World Register of Marine Species (WoRMS). The function checks both Aphia IDs and scientific names,
handles missing records, and assigns the appropriate plankton group based on taxonomic classification in WoRMS.
Additionally, custom plankton groups can be specified using the custom_groups parameter,
allowing users to define additional classifications based on specific taxonomic criteria."><meta property="og:description" content="This function assigns default phytoplankton groups (Diatoms, Dinoflagellates, Cyanobacteria, or Other)
to a list of scientific names or Aphia IDs by retrieving species information from the
World Register of Marine Species (WoRMS). The function checks both Aphia IDs and scientific names,
handles missing records, and assigns the appropriate plankton group based on taxonomic classification in WoRMS.
Additionally, custom plankton groups can be specified using the custom_groups parameter,
allowing users to define additional classifications based on specific taxonomic criteria."><meta property="og:image" content="https://sharksmhi.github.io/SHARK4R/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">SHARK4R</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-tutorials" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Tutorials</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-tutorials"><li><a class="dropdown-item" href="../articles/retrieve_shark_data.html">Retrieve SHARK Data</a></li>
    <li><a class="dropdown-item" href="../articles/retrieve_dyntaxa_data.html">Retrieve Dyntaxa Data</a></li>
    <li><a class="dropdown-item" href="../articles/retrieve_worms_data.html">Retrieve WoRMS Data</a></li>
    <li><a class="dropdown-item" href="../articles/retrieve_algaebase_data.html">Retrieve AlgaeBase Data</a></li>
    <li><a class="dropdown-item" href="../articles/retrieve_hab_data.html">Retrieve HAB Data</a></li>
    <li><a class="dropdown-item" href="../articles/retrieve_nordic_microalgae_data.html">Retrieve Nordic Microalgae Data</a></li>
    <li><a class="dropdown-item" href="../articles/quality_control.html">QC of SHARK Data</a></li>
  </ul></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/sharksmhi/SHARK4R/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Assign phytoplankton group to scientific names</h1>
      <small class="dont-index">Source: <a href="https://github.com/sharksmhi/SHARK4R/blob/v.1.0.1/R/worms_api_functions.R" class="external-link"><code>R/worms_api_functions.R</code></a></small>
      <div class="d-none name"><code>assign_phytoplankton_group.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function assigns default phytoplankton groups (Diatoms, Dinoflagellates, Cyanobacteria, or Other)
to a list of scientific names or Aphia IDs by retrieving species information from the
World Register of Marine Species (WoRMS). The function checks both Aphia IDs and scientific names,
handles missing records, and assigns the appropriate plankton group based on taxonomic classification in WoRMS.
Additionally, custom plankton groups can be specified using the <code>custom_groups</code> parameter,
allowing users to define additional classifications based on specific taxonomic criteria.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">assign_phytoplankton_group</span><span class="op">(</span></span>
<span>  <span class="va">scientific_names</span>,</span>
<span>  aphia_ids <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  diatom_class <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Bacillariophyceae"</span>, <span class="st">"Coscinodiscophyceae"</span>, <span class="st">"Mediophyceae"</span>,</span>
<span>    <span class="st">"Diatomophyceae"</span><span class="op">)</span>,</span>
<span>  dinoflagellate_class <span class="op">=</span> <span class="st">"Dinophyceae"</span>,</span>
<span>  cyanobacteria_class <span class="op">=</span> <span class="st">"Cyanophyceae"</span>,</span>
<span>  cyanobacteria_phylum <span class="op">=</span> <span class="st">"Cyanobacteria"</span>,</span>
<span>  match_first_word <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  marine_only <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  return_class <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  custom_groups <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-scientific-names">scientific_names<a class="anchor" aria-label="anchor" href="#arg-scientific-names"></a></dt>
<dd><p>A character vector of scientific names of marine species.</p></dd>


<dt id="arg-aphia-ids">aphia_ids<a class="anchor" aria-label="anchor" href="#arg-aphia-ids"></a></dt>
<dd><p>A numeric vector of Aphia IDs corresponding to the scientific names. If provided, it improves the accuracy and speed of the matching process. The length of <code>aphia_ids</code> must match the length of <code>scientific_names</code>. Defaults to <code>NULL</code>, in which case the function will attempt to assign plankton groups based only on the scientific names.</p></dd>


<dt id="arg-diatom-class">diatom_class<a class="anchor" aria-label="anchor" href="#arg-diatom-class"></a></dt>
<dd><p>A character string or vector representing the diatom class. Default is "Bacillariophyceae", "Coscinodiscophyceae", "Mediophyceae" and "Diatomophyceae".</p></dd>


<dt id="arg-dinoflagellate-class">dinoflagellate_class<a class="anchor" aria-label="anchor" href="#arg-dinoflagellate-class"></a></dt>
<dd><p>A character string or vector representing the dinoflagellate class. Default is "Dinophyceae".</p></dd>


<dt id="arg-cyanobacteria-class">cyanobacteria_class<a class="anchor" aria-label="anchor" href="#arg-cyanobacteria-class"></a></dt>
<dd><p>A character string or vector representing the cyanobacteria class. Default is "Cyanophyceae".</p></dd>


<dt id="arg-cyanobacteria-phylum">cyanobacteria_phylum<a class="anchor" aria-label="anchor" href="#arg-cyanobacteria-phylum"></a></dt>
<dd><p>A character string or vector representing the cyanobacteria phylum. Default is "Cyanobacteria".</p></dd>


<dt id="arg-match-first-word">match_first_word<a class="anchor" aria-label="anchor" href="#arg-match-first-word"></a></dt>
<dd><p>A logical value indicating whether to match the first word of the scientific name if the Aphia ID is missing. Default is TRUE.</p></dd>


<dt id="arg-marine-only">marine_only<a class="anchor" aria-label="anchor" href="#arg-marine-only"></a></dt>
<dd><p>A logical value indicating whether to restrict the results to marine taxa only. Default is <code>FALSE</code>.</p></dd>


<dt id="arg-return-class">return_class<a class="anchor" aria-label="anchor" href="#arg-return-class"></a></dt>
<dd><p>A logical value indicating whether to include class information in the result. Default is <code>FALSE</code>.</p></dd>


<dt id="arg-custom-groups">custom_groups<a class="anchor" aria-label="anchor" href="#arg-custom-groups"></a></dt>
<dd><p>A named list of additional custom plankton groups (optional). The names of the list correspond to the custom group names (e.g., "Cryptophytes"), and the values should be character vectors specifying one or more of the following taxonomic levels: <code>phylum</code>, <code>class</code>, <code>order</code>, <code>family</code>, <code>genus</code>, or <code>scientific_name</code>. For example:
<code>list("Green Algae" = list(class = c("Chlorophyceae", "Ulvophyceae")))</code>.
This allows users to extend the default classifications (e.g., Cyanobacteria, Diatoms, Dinoflagellates) with their own groups.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>A logical value indicating whether to print progress messages. Default is TRUE.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <code>tibble</code> with two columns: <code>scientific_name</code> and <code>plankton_group</code>, where the plankton group is assigned based on taxonomic classification.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The <code>aphia_ids</code> parameter is not necessary but, if provided, will improve the certainty of the
matching process. If <code>aphia_ids</code> are available, they will be used directly to retrieve more accurate
WoRMS records. If missing, the function will attempt to match the scientific names to Aphia IDs by
querying WoRMS using the scientific name(s), with an additional fallback mechanism to match based on the
first word of the scientific name.</p>
<p>To skip one of the default plankton groups, you can set the class or phylum of the respective group to an empty string (<code>""</code>).
For example, to skip the "Cyanobacteria" group, you can set <code>cyanobacteria_class = ""</code> or <code>cyanobacteria_phylum = ""</code>. These
taxa will then be placed in <code>Others</code>.</p>
<p>Custom groups are processed in the order they appear in the <code>custom_groups</code> list. If a taxon matches
multiple custom groups, it will be assigned to the group that appears last in the list, as later matches
overwrite earlier ones. For example, if <code>Teleaulax amphioxeia</code> matches both <code>Cryptophytes</code> (class-based)
and a specific group <code>Teleaulax</code> (name-based), it will be assigned to <code>Teleaulax</code> if <code>Teleaulax</code> is listed after
<code>Cryptophytes</code> in the <code>custom_groups</code> list.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><a href="https://marinespecies.org/" class="external-link">https://marinespecies.org/</a> for WoRMS website.</p>
<p><a href="https://CRAN.R-project.org/package=worrms" class="external-link">https://CRAN.R-project.org/package=worrms</a></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co"># Assign plankton groups to a list of species</span></span></span>
<span class="r-in"><span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu">assign_phytoplankton_group</span><span class="op">(</span></span></span>
<span class="r-in"><span>  scientific_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Tripos fusus"</span>, <span class="st">"Diatoma"</span>, <span class="st">"Nodularia spumigena"</span>, <span class="st">"Octactis speculum"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  aphia_ids <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">840626</span>, <span class="fl">149013</span>, <span class="fl">160566</span>, <span class="cn">NA</span><span class="op">)</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 4 × 2</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   scientific_name     plankton_group </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>               <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> Tripos fusus        Dinoflagellates</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> Diatoma             Diatoms        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span> Nodularia spumigena Cyanobacteria  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span> Octactis speculum   Other          </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Assign plankton groups using additional custom grouping</span></span></span>
<span class="r-in"><span><span class="va">custom_groups</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    Cryptophytes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>class <span class="op">=</span> <span class="st">"Cryptophyceae"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    Ciliates <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>phylum <span class="op">=</span> <span class="st">"Ciliophora"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Assign with custom groups</span></span></span>
<span class="r-in"><span><span class="va">result_custom</span> <span class="op">&lt;-</span> <span class="fu">assign_phytoplankton_group</span><span class="op">(</span></span></span>
<span class="r-in"><span>  scientific_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Teleaulax amphioxeia"</span>, <span class="st">"Mesodinium rubrum"</span>, <span class="st">"Dinophysis acuta"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  aphia_ids <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">106306</span>, <span class="fl">232069</span>, <span class="fl">109604</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  custom_groups <span class="op">=</span> <span class="va">custom_groups</span>,         <span class="co"># Adding custom groups</span></span></span>
<span class="r-in"><span>  verbose <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">result_custom</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 3 × 2</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   scientific_name      plankton_group </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> Teleaulax amphioxeia Cryptophytes   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> Mesodinium rubrum    Ciliates       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span> Dinophysis acuta     Dinoflagellates</span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Markus Lindh, Anders Torstensson, SBDI.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

